const playPausebtn=document.querySelector(".play-pause-btn"),theaterbtn=document.querySelector(".theater-btn"),fullscreenbtn=document.querySelector(".fullscreen-btn"),miniplayerbtn=document.querySelector(".mini-player-btn"),video=document.querySelector("video"),videoContainer=document.querySelector(".video-container"),muteBtn=document.querySelector(".mute-btn"),volumeSlider=document.querySelector(".volume-slider"),currentTimeEl=document.querySelector(".current-time"),totalTimeEl=document.querySelector(".total-time"),captionsBtn=document.querySelector(".captions-btn"),speedBtn=document.querySelector(".speed-btn"),timelineContainer=document.querySelector(".timeline-container"),thumbnailImg=document.querySelector(".thumbnail-img"),previewImg=document.querySelector(".preview-img");document.addEventListener("keydown",(e=>{const t=document.activeElement.tagName.toLowerCase();if("input"!==t)switch(e.key.toLowerCase()){case" ":if("button"===t)return;case"k":togglePlay();break;case"f":tooglefullscreenmode();break;case"t":toogletheatermode();break;case"i":toogleminiplayermode();break;case"m":toogleMute();break;case"j":skip(-5);break;case"l":skip(5);break;case"c":toogleCaptions();break}})),timelineContainer.addEventListener("mousemove",handleTimelineUpdate),timelineContainer.addEventListener("mousedown",toggleScrubbing),document.addEventListener("mouseup",(e=>{isScrubbing&&toggleScrubbing(e)})),document.addEventListener("mousemove",(e=>{isScrubbing&&handleTimelineUpdate(e)}));let wasPaused,isScrubbing=!1;function toggleScrubbing(e){const t=timelineContainer.getBoundingClientRect(),n=Math.min(Math.max(0,e.x-t.x),t.width)/t.width;isScrubbing=1==(1&e.buttons),videoContainer.classList.toggle("scrubbing",isScrubbing),isScrubbing?(wasPaused=video.paused,video.pause()):(video.currentTime=n*video.duration,wasPaused||video.play()),handleTimelineUpdate(e)}function handleTimelineUpdate(e){const t=timelineContainer.getBoundingClientRect(),n=Math.min(Math.max(0,e.x-t.x),t.width)/t.width,i=`assets/previewImgs/preview${Math.max(1,Math.floor(n*video.duration/10))}.jpg`;previewImg.src=i,timelineContainer.style.setProperty("--preview-position",n),isScrubbing&&(e.preventDefault(),thumbnailImg.src=i,timelineContainer.style.setProperty("--progress-position",n))}function changePlaybackSpeed(){let e=video.playbackRate+.25;e>2&&(e=.25),video.playbackRate=e,speedBtn.textContent=`${e}x`}speedBtn.addEventListener("click",changePlaybackSpeed);const captions=video.textTracks[0];function toogleCaptions(){const e="hidden"===captions.mode;captions.mode=e?"showing":"hidden",videoContainer.classList.toggle("captions",e)}captions.mode="hidden",captionsBtn.addEventListener("click",toogleCaptions),video.addEventListener("loadeddata",(()=>{totalTimeEl.textContent=formatDuration(video.duration)})),video.addEventListener("timeupdate",(()=>{currentTimeEl.textContent=formatDuration(video.currentTime)}));const leadingZeroFormatter=new Intl.NumberFormat(void 0,{minimumIntegerDigits:2});function formatDuration(e){const t=Math.floor(e%60),n=Math.floor(e/60)%60,i=Math.floor(e/3600);return 0===i?`${n}:${leadingZeroFormatter.format(t)}`:`${i}:${leadingZeroFormatter.format(n)}:${leadingZeroFormatter.format(t)}`}function skip(e){video.currentTime+=e}function toogleMute(){video.muted=!video.muted}function toogletheatermode(){videoContainer.classList.toggle("theater")}function tooglefullscreenmode(){null==document.fullscreenElement?videoContainer.requestFullscreen():document.exitFullscreen()}function toogleminiplayermode(){videoContainer.classList.contains("mini-player")?document.exitPictureInPicture():video.requestPictureInPicture()}function togglePlay(){video.paused?video.play():video.pause()}muteBtn.addEventListener("click",toogleMute),volumeSlider.addEventListener("input",(e=>{video.volume=e.target.value,video.muted=0===e.target.value})),video.addEventListener("volumechange",(()=>{let e;volumeSlider.value=video.volume,video.muted||0===video.volume?(volumeSlider.value=0,e="muted"):e=video.volume>=.5?"high":"low",videoContainer.dataset.volumeLevel=e})),theaterbtn.addEventListener("click",toogletheatermode),fullscreenbtn.addEventListener("click",tooglefullscreenmode),miniplayerbtn.addEventListener("click",toogleminiplayermode),document.addEventListener("fullscreenchange",(()=>{videoContainer.classList.toggle("fullscreen",document.fullscreenElement)})),video.addEventListener("enterpictureinpicture",(()=>{videoContainer.classList.add("mini-player")})),video.addEventListener("leavepictureinpicture",(()=>{videoContainer.classList.remove("mini-player")})),playPausebtn.addEventListener("click",togglePlay),video.addEventListener("click",togglePlay),video.addEventListener("play",(()=>{videoContainer.classList.remove("paused")})),video.addEventListener("pause",(()=>{videoContainer.classList.add("paused")}));